<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <!-- import CSS -->
  <link rel="stylesheet" href="css/eui.css">
  <style>

    .el-aside {
      color: #333;
    }
    h1{
      float: left;
      font-size: 22px;
      color: white;
      margin: 0;
    }
    .el-header{
      background-color: #0095d7;
      color: #333;
      line-height: 60px; /*实现垂直居中效果*/
    }
  </style>
</head>
<body>
<div id="app">
  <el-container style="height: 500px; border: 1px solid #eee">
    <el-header style="text-align: right; font-size: 12px">
      <h1>CoolShark商城后台管理系统</h1>

      <span>欢迎xxx回来!</span>
      <a href="javascript:void(0)" @click="logout()">退出登录</a>
    </el-header>

    <el-container>
      <el-aside width="200px" style="background-color: rgb(238, 241, 246)">
        <el-menu :default-openeds="['1']" @select="menuChange">
          <el-submenu index="1">
            <template slot="title"><i class="el-icon-s-flag"></i>分类管理</template>
            <el-menu-item index="1-1">分类列表</el-menu-item>
            <el-menu-item index="1-2">添加分类</el-menu-item>
          </el-submenu>
          <el-submenu index="2">
            <template slot="title"><i class="el-icon-picture"></i>轮播图管理</template>
            <el-menu-item index="2-1">轮播图列表</el-menu-item>
            <el-menu-item index="2-2">添加轮播图</el-menu-item>
          </el-submenu>
          <el-submenu index="3">
            <template slot="title"><i class="el-icon-shopping-cart-2"></i>商品管理</template>
            <el-menu-item index="3-1">商品列表</el-menu-item>
            <el-menu-item index="3-2">添加商品</el-menu-item>
          </el-submenu>

        </el-menu>
      </el-aside>

      <el-main>
        <el-table v-show="index=='1-1'" :data="categoryArr">
          <!--设置表格的第一列为编号/序号  label相当于表头-->
          <el-table-column type="index" label="编号" width="140">
          </el-table-column>
          <!--prop代表数组中对象的属性名-->
          <el-table-column prop="name" label="分类名称">
          </el-table-column>
          <el-table-column label="操作">
            <!--scope对象中会装着当前遍历的信息-->
            <template slot-scope="scope">
              <!--气泡确认组件 scope.$index代表遍历对象在数组中的下标
              scope.row代表当前遍历的分类对象-->
              <el-popconfirm title="您确认删除此分类吗?"
                             @confirm="categoryDelete(scope.$index,scope.row)">
                <el-button size="mini" type="danger" slot="reference">删除</el-button>
              </el-popconfirm>
            </template>
          </el-table-column>
        </el-table>
        <el-table v-show="index=='2-1'" :data="tableData">
          <el-table-column prop="date" label="轮播图" width="140">
          </el-table-column>
        </el-table>
        <el-table v-show="index=='3-1'" :data="tableData">
          <el-table-column prop="date" label="商品" width="140">
          </el-table-column>
        </el-table>
      </el-main>
    </el-container>
  </el-container>

</div>
</body>
<script src="js/vue.min.js"></script>
<!-- import JavaScript -->
<script src="js/eui.js"></script>
<script src="js/axios.min.js"></script>
<script>
  let v = new Vue({
    el: '#app',
    data() {
      const item = {
        date: '2016-05-02',
        name: '王小虎',
        address: '上海市普陀区金沙江路 1518 弄'
      };
      return {
        tableData: Array(20).fill(item),
        index:"1-1",
        categoryArr:[]
      }
    },
    created:function(){
        //发请求获取所有分类数据  this代表当前Vue对象
      //此处的this不能用v代替  created方法执行时 v还没有赋值
        this.loadCategory();
        //created方法中只能用this   axios发请求后只能用v
    },
    methods:{
      loadCategory(){
        axios.get("/category/select").then(function (response) {
          v.categoryArr = response.data;
        })
      },
      menuChange(index){
        if (index=="1-2"){
          alert("点击了添加分类");
        }else if(index=="2-2"){
          alert("点击了添加轮播图");
        }else if(index=="3-2"){
          alert("点击了添加商品");
        }else{
          alert("点击了列表")
          v.index = index;
        }
      },
      categoryDelete(index,category){
        //发请求删除分类
        axios.get("/category/delete?id="+category.id).then(function (response) {
          //重新加载分类数据 因为此处开了子线程删除分类,当此处代码执行时
          //this 已经不是Vue对象了  只能使用v访问方法
          v.loadCategory();
        })
      }
    }
  })
</script>
</html>